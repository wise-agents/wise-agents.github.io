<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>core - wise-agents Docs</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "core";
        var mkdocs_page_input_path = "reference/wiseagents/core.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> wise-agents Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../multi_agents/">What are AI Agents</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../wise_agents_architecture/">Wise Agents architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../contributing/">How to contribute</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Details</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../rag_architecture/">RAG Architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../using_cli/">Using CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../declare_agents/">Declare agents in YAML</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../custom_agents/">How To Create Custom Agents</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Examples</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../agentic_chatbot/">Agentic chatbot</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../sequential_coordinator_example/">Sequential Coordinator Example</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="../">wiseagents</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../agents/">agents</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../agents/assistant/">assistant</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../agents/coordinator_wise_agents/">coordinator_wise_agents</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../agents/rag_wise_agents/">rag_wise_agents</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../agents/utility_wise_agents/">utility_wise_agents</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../cli/">cli</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../cli/wise_agent_cli/">wise_agent_cli</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../constants/">constants</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">core</a>
    <ul class="current">
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../graphdb/">graphdb</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../graphdb/lang_chain_wise_agent_graph_db/">lang_chain_wise_agent_graph_db</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../graphdb/wise_agent_graph_db/">wise_agent_graph_db</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../llm/">llm</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../llm/openai_API_wise_agent_LLM/">openai_API_wise_agent_LLM</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../llm/wise_agent_LLM/">wise_agent_LLM</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../llm/wise_agent_remote_LLM/">wise_agent_remote_LLM</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../transports/">transports</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../transports/stomp/">stomp</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../vectordb/">vectordb</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../vectordb/lang_chain_wise_agent_vector_db/">lang_chain_wise_agent_vector_db</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../vectordb/wise_agent_vector_db/">wise_agent_vector_db</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../wise_agent_messaging/">wise_agent_messaging</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../yaml/">yaml</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../yaml/wise_yaml_loader/">wise_yaml_loader</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../yaml/yaml_utils/">yaml_utils</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../community/">Community</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../contributing_lnk/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../license/">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../security/">Security</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">wise-agents Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">API Reference</li>
          <li class="breadcrumb-item"><a href="../">wiseagents</a></li>
      <li class="breadcrumb-item active">core</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="doc doc-object doc-module">



<a id="wiseagents.core"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="wiseagents.core.WiseAgent" class="doc doc-heading">
            <code>WiseAgent</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="yaml.YAMLObject">YAMLObject</span></code></p>


        <p>A WiseAgent is an abstract class that represents an agent that can send and receive messages to and from other agents.</p>

              <details class="quote">
                <summary>Source code in <code>wiseagents/core.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">WiseAgent</span><span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">YAMLObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; A WiseAgent is an abstract class that represents an agent that can send and receive messages to and from other agents.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">yaml_tag</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;!wiseagents.WiseAgent&#39;</span>
    <span class="n">yaml_loader</span> <span class="o">=</span> <span class="n">WiseAgentsLoader</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Create a new instance of the class, setting default values for the instance variables.&#39;&#39;&#39;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_llm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_vector_db</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_graph_db</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_collection_name</span> <span class="o">=</span> <span class="s2">&quot;wise-agent-collection&quot;</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_system_message</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">transport</span><span class="p">:</span> <span class="n">WiseAgentTransport</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WiseAgentLLM</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">vector_db</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WiseAgentVectorDB</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">collection_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;wise-agent-collection&quot;</span><span class="p">,</span>
                 <span class="n">graph_db</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WiseAgentGraphDB</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">system_message</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39; </span>
<span class="sd">        Initialize the agent with the given name, description, transport, LLM, vector DB, collection name, and graph DB.</span>


<span class="sd">        Args:</span>
<span class="sd">            name (str): the name of the agent</span>
<span class="sd">            description (str): a description of what the agent does</span>
<span class="sd">            transport (WiseAgentTransport): the transport to use for sending and receiving messages</span>
<span class="sd">            llm (Optional[WiseAgentLLM]): the LLM associated with the agent</span>
<span class="sd">            vector_db (Optional[WiseAgentVectorDB]): the vector DB associated with the agent</span>
<span class="sd">            collection_name (Optional[str]) = &quot;wise-agent-collection&quot;: the vector DB collection name associated with the agent</span>
<span class="sd">            graph_db (Optional[WiseAgentGraphDB]): the graph DB associated with the agent</span>
<span class="sd">            system_message Optional(str): an optional system message that can be used by the agent when processing chat</span>
<span class="sd">            completions using its LLM</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">=</span> <span class="n">description</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_llm</span> <span class="o">=</span> <span class="n">llm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vector_db</span> <span class="o">=</span> <span class="n">vector_db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_name</span> <span class="o">=</span> <span class="n">collection_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_graph_db</span> <span class="o">=</span> <span class="n">graph_db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transport</span> <span class="o">=</span> <span class="n">transport</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_system_message</span> <span class="o">=</span> <span class="n">system_message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_agent</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">start_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39; Start the agent by setting the call backs and starting the transport.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">set_call_backs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_event</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_error</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">process_response</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stop_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39; Stop the agent by stopping the transport and removing the agent from the registry.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">unregister_agent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Return a string representation of the agent.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, description=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">, llm=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">llm</span><span class="si">}</span><span class="s2">,&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;vector_db=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_db</span><span class="si">}</span><span class="s2">, collection_name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_collection_name</span><span class="si">}</span><span class="s2">, graph_db=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_db</span><span class="si">}</span><span class="s2">,&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;system_message=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">system_message</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">WiseAgent</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span> <span class="o">==</span> <span class="n">value</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of the agent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a description of what the agent does.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">llm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WiseAgentLLM</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the LLM associated with the agent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vector_db</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WiseAgentVectorDB</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the vector DB associated with the agent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vector_db</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">collection_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the vector DB collection name associated with the agent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">graph_db</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WiseAgentGraphDB</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the graph DB associated with the agent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph_db</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">transport</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WiseAgentTransport</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the transport associated with the agent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transport</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">system_message</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the system message associated with the agent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_system_message</span>

    <span class="k">def</span> <span class="nf">send_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">,</span> <span class="n">dest_agent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Send a request message to the destination agent with the given name.</span>

<span class="sd">        Args:</span>
<span class="sd">            message (WiseAgentMessage): the message to send</span>
<span class="sd">            dest_agent_name (str): the name of the destination agent&#39;&#39;&#39;</span>
        <span class="n">message</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">get_or_create_context</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">context_name</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">add_participant</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">send_request</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">dest_agent_name</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">send_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">,</span> <span class="n">dest_agent_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Send a response message to the destination agent with the given name.</span>

<span class="sd">        Args:</span>
<span class="sd">            message (WiseAgentMessage): the message to send</span>
<span class="sd">            dest_agent_name (str): the name of the destination agent&#39;&#39;&#39;</span>
        <span class="n">message</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">get_or_create_context</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">context_name</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">add_participant</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">dest_agent_name</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">handle_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback method to handle the given request for this agent. This method optionally retrieves</span>
<span class="sd">        conversation history from the shared context depending on the type of collaboration the agent</span>
<span class="sd">        is involved in (i.e., sequential, phased, or independent) and passes this to the process_request</span>
<span class="sd">        method. Finally, it handles the response from the process_request method, ensuring the shared</span>
<span class="sd">        context is updated if necessary, and determines which agent to the send the response to, both</span>
<span class="sd">        depending on the type of collaboration the agent is involved in.</span>

<span class="sd">        Args:</span>
<span class="sd">            request (WiseAgentMessage): the request message to be processed</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the message was processed successfully, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">get_or_create_context</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">context_name</span><span class="p">)</span>
        <span class="n">collaboration_type</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get_collaboration_type</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">)</span>
        <span class="n">conversation_history</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_conversation_history_if_needed</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">,</span> <span class="n">collaboration_type</span><span class="p">)</span>
        <span class="n">response_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_request</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">conversation_history</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_response</span><span class="p">(</span><span class="n">response_str</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">collaboration_type</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_conversation_history_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">WiseAgentContext</span><span class="p">,</span>
                                           <span class="n">chat_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">collaboration_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span>
        <span class="n">ChatCompletionMessageParam</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the conversation history for the given chat id from the given context, depending on the</span>
<span class="sd">        type of collaboration the agent is involved in (i.e., sequential, phased, independent).</span>

<span class="sd">        Args:</span>
<span class="sd">            context (WiseAgentContext): the shared context</span>
<span class="sd">            chat_id (Optional[str]): the chat id, may be None</span>
<span class="sd">            collaboration_type (str): the type of collaboration this agent is involved in</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[ChatCompletionMessageParam]: the conversation history for the given chat id if the agent</span>
<span class="sd">            is involved in a collaboration type that makes use of the conversation history and an empty list</span>
<span class="sd">            otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">chat_id</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">collaboration_type</span> <span class="o">==</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">PHASED</span>
                    <span class="ow">or</span> <span class="n">collaboration_type</span> <span class="o">==</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">CHAT</span><span class="p">):</span>
                <span class="c1"># this agent is involved in phased collaboration or a chat, so it needs the conversation history</span>
                <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">llm_chat_completion</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_id</span><span class="p">)</span>
        <span class="c1"># for sequential collaboration and independent agents, the shared history is not needed</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">process_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">,</span>
                        <span class="n">conversation_history</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionMessageParam</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Process the given request message to generate a response string.</span>

<span class="sd">        Args:</span>
<span class="sd">            request (WiseAgentMessage): the request message to be processed</span>
<span class="sd">            conversation_history (List[ChatCompletionMessageParam]): The conversation history that</span>
<span class="sd">            can be used while processing the request. If this agent isn&#39;t involved in a type of</span>
<span class="sd">            collaboration that makes use of the conversation history, this will be an empty list.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Optional[str]: the response to the request message as a string or None if there is</span>
<span class="sd">            no string response yet</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">handle_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">,</span>
                        <span class="n">context</span><span class="p">:</span> <span class="n">WiseAgentContext</span><span class="p">,</span> <span class="n">collaboration_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles the given string response, ensuring the shared context is updated if necessary</span>
<span class="sd">        and determines which agent to the send the response to, both depending on the type of</span>
<span class="sd">        collaboration the agent is involved in (i.e., sequential, phased, or independent).</span>

<span class="sd">        Args:</span>
<span class="sd">            response_str (str): the string response to be handled</span>
<span class="sd">            context (WiseAgentContext): the shared context</span>
<span class="sd">            chat_id (Optional[str]): the chat id, may be None</span>
<span class="sd">            collaboration_type (str): the type of collaboration this agent is involved in</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the message was processed successfully, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">response_str</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">collaboration_type</span> <span class="o">==</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">PHASED</span>
                    <span class="ow">or</span> <span class="n">collaboration_type</span> <span class="o">==</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">CHAT</span><span class="p">):</span>
                <span class="c1"># add this agent&#39;s response to the shared context</span>
                <span class="n">context</span><span class="o">.</span><span class="n">append_chat_completion</span><span class="p">(</span><span class="n">chat_uuid</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">,</span>
                                               <span class="n">messages</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;assistant&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">response_str</span><span class="p">})</span>

                <span class="c1"># let the sender know that this agent has finished processing the request</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span>
                    <span class="n">WiseAgentMessage</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">response_str</span><span class="p">,</span> <span class="n">message_type</span><span class="o">=</span><span class="n">WiseAgentMessageType</span><span class="o">.</span><span class="n">ACK</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                     <span class="n">context_name</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                     <span class="n">chat_id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">),</span> <span class="n">request</span><span class="o">.</span><span class="n">sender</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">collaboration_type</span> <span class="o">==</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">SEQUENTIAL</span><span class="p">:</span>
                <span class="n">next_agent</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get_next_agent_in_sequence</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">next_agent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sequential coordination complete - sending response from &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; to &quot;</span>
                                  <span class="o">+</span> <span class="n">context</span><span class="o">.</span><span class="n">get_route_response_to</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span><span class="n">WiseAgentMessage</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">response_str</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                        <span class="n">context_name</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">chat_id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">),</span>
                                       <span class="n">context</span><span class="o">.</span><span class="n">get_route_response_to</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sequential coordination continuing - sending response from &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
                                  <span class="o">+</span> <span class="s2">&quot; to &quot;</span> <span class="o">+</span> <span class="n">next_agent</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">send_request</span><span class="p">(</span>
                        <span class="n">WiseAgentMessage</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">response_str</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">context_name</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                         <span class="n">chat_id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">),</span> <span class="n">next_agent</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span><span class="n">WiseAgentMessage</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">response_str</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                    <span class="n">context_name</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">chat_id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">),</span>
                                   <span class="n">request</span><span class="o">.</span><span class="n">sender</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">process_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback method to process the response received from another agent which processed a request from this agent.</span>


<span class="sd">        Args:</span>
<span class="sd">            message (WiseAgentMessage): the message to be processed</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the message was processed successfully, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">process_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">WiseAgentEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback method to process the given event.</span>


<span class="sd">        Args:</span>
<span class="sd">            event (WiseAgentEvent): the event to be processed</span>

<span class="sd">        Returns:</span>
<span class="sd">           True if the event was processed successfully, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">process_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback method to process the given error.</span>


<span class="sd">        Args:</span>
<span class="sd">            error (Exception): the error to be processed</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the error was processed successfully, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgent.collection_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">collection_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the vector DB collection name associated with the agent.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgent.description" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">description</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get a description of what the agent does.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgent.graph_db" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">graph_db</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WiseAgentGraphDB</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the graph DB associated with the agent.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgent.llm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">llm</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WiseAgentLLM</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the LLM associated with the agent.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgent.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the name of the agent.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgent.system_message" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">system_message</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the system message associated with the agent.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgent.transport" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transport</span><span class="p">:</span> <span class="n">WiseAgentTransport</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the transport associated with the agent.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgent.vector_db" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vector_db</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WiseAgentVectorDB</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the vector DB associated with the agent.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">transport</span><span class="p">,</span> <span class="n">llm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vector_db</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="s1">&#39;wise-agent-collection&#39;</span><span class="p">,</span> <span class="n">graph_db</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">system_message</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the agent with the given name, description, transport, LLM, vector DB, collection name, and graph DB.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>name</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the name of the agent</p>
              </div>
            </li>
            <li>
              <b><code>description</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>a description of what the agent does</p>
              </div>
            </li>
            <li>
              <b><code>transport</code></b>
                  (<code><a class="autorefs autorefs-internal" title="wiseagents.wise_agent_messaging.WiseAgentTransport" href="../wise_agent_messaging/#wiseagents.wise_agent_messaging.WiseAgentTransport">WiseAgentTransport</a></code>)
              
              <div class="doc-md-description">
                <p>the transport to use for sending and receiving messages</p>
              </div>
            </li>
            <li>
              <b><code>llm</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="wiseagents.llm.WiseAgentLLM" href="../llm/#wiseagents.llm.WiseAgentLLM">WiseAgentLLM</a>]</code>, default:
                      <code>None</code>
)
              
              <div class="doc-md-description">
                <p>the LLM associated with the agent</p>
              </div>
            </li>
            <li>
              <b><code>vector_db</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="wiseagents.vectordb.WiseAgentVectorDB" href="../vectordb/#wiseagents.vectordb.WiseAgentVectorDB">WiseAgentVectorDB</a>]</code>, default:
                      <code>None</code>
)
              
              <div class="doc-md-description">
                <p>the vector DB associated with the agent</p>
              </div>
            </li>
            <li>
              <b><code>collection_name</code></b>
                  (<code>Optional[str]) = &#34;wise-agent-collection&#34;</code>, default:
                      <code>&#39;wise-agent-collection&#39;</code>
)
              
              <div class="doc-md-description">
                <p>the vector DB collection name associated with the agent</p>
              </div>
            </li>
            <li>
              <b><code>graph_db</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="wiseagents.graphdb.WiseAgentGraphDB" href="../graphdb/#wiseagents.graphdb.WiseAgentGraphDB">WiseAgentGraphDB</a>]</code>, default:
                      <code>None</code>
)
              
              <div class="doc-md-description">
                <p>the graph DB associated with the agent</p>
              </div>
            </li>
            <li>
              <b><code>system_message</code></b>
                  (<code>Optional(str</code>, default:
                      <code>None</code>
)
              
              <div class="doc-md-description">
                <p>an optional system message that can be used by the agent when processing chat</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">transport</span><span class="p">:</span> <span class="n">WiseAgentTransport</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WiseAgentLLM</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">vector_db</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WiseAgentVectorDB</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">collection_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;wise-agent-collection&quot;</span><span class="p">,</span>
             <span class="n">graph_db</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WiseAgentGraphDB</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">system_message</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; </span>
<span class="sd">    Initialize the agent with the given name, description, transport, LLM, vector DB, collection name, and graph DB.</span>


<span class="sd">    Args:</span>
<span class="sd">        name (str): the name of the agent</span>
<span class="sd">        description (str): a description of what the agent does</span>
<span class="sd">        transport (WiseAgentTransport): the transport to use for sending and receiving messages</span>
<span class="sd">        llm (Optional[WiseAgentLLM]): the LLM associated with the agent</span>
<span class="sd">        vector_db (Optional[WiseAgentVectorDB]): the vector DB associated with the agent</span>
<span class="sd">        collection_name (Optional[str]) = &quot;wise-agent-collection&quot;: the vector DB collection name associated with the agent</span>
<span class="sd">        graph_db (Optional[WiseAgentGraphDB]): the graph DB associated with the agent</span>
<span class="sd">        system_message Optional(str): an optional system message that can be used by the agent when processing chat</span>
<span class="sd">        completions using its LLM</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">=</span> <span class="n">description</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_llm</span> <span class="o">=</span> <span class="n">llm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_vector_db</span> <span class="o">=</span> <span class="n">vector_db</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_collection_name</span> <span class="o">=</span> <span class="n">collection_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_graph_db</span> <span class="o">=</span> <span class="n">graph_db</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_transport</span> <span class="o">=</span> <span class="n">transport</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_system_message</span> <span class="o">=</span> <span class="n">system_message</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_agent</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.__new__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__new__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new instance of the class, setting default values for the instance variables.</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Create a new instance of the class, setting default values for the instance variables.&#39;&#39;&#39;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">_llm</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">_vector_db</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">_graph_db</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">_collection_name</span> <span class="o">=</span> <span class="s2">&quot;wise-agent-collection&quot;</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">_system_message</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a string representation of the agent.</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Return a string representation of the agent.&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, description=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">, llm=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">llm</span><span class="si">}</span><span class="s2">,&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;vector_db=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_db</span><span class="si">}</span><span class="s2">, collection_name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_collection_name</span><span class="si">}</span><span class="s2">, graph_db=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_db</span><span class="si">}</span><span class="s2">,&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;system_message=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">system_message</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.get_conversation_history_if_needed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_conversation_history_if_needed</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">chat_id</span><span class="p">,</span> <span class="n">collaboration_type</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the conversation history for the given chat id from the given context, depending on the
type of collaboration the agent is involved in (i.e., sequential, phased, independent).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>context</code></b>
                  (<code><a class="autorefs autorefs-internal" title="wiseagents.core.WiseAgentContext" href="#wiseagents.core.WiseAgentContext">WiseAgentContext</a></code>)
              
              <div class="doc-md-description">
                <p>the shared context</p>
              </div>
            </li>
            <li>
              <b><code>chat_id</code></b>
                  (<code><span title="typing.Optional">Optional</span>[str]</code>)
              
              <div class="doc-md-description">
                <p>the chat id, may be None</p>
              </div>
            </li>
            <li>
              <b><code>collaboration_type</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the type of collaboration this agent is involved in</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[<span title="openai.types.chat.ChatCompletionMessageParam">ChatCompletionMessageParam</span>]</code>
              
              <div class="doc-md-description">
                <p>List[ChatCompletionMessageParam]: the conversation history for the given chat id if the agent</p>
              </div>
            </li>
            <li>
                  <code><span title="typing.List">List</span>[<span title="openai.types.chat.ChatCompletionMessageParam">ChatCompletionMessageParam</span>]</code>
              
              <div class="doc-md-description">
                <p>is involved in a collaboration type that makes use of the conversation history and an empty list</p>
              </div>
            </li>
            <li>
                  <code><span title="typing.List">List</span>[<span title="openai.types.chat.ChatCompletionMessageParam">ChatCompletionMessageParam</span>]</code>
              
              <div class="doc-md-description">
                <p>otherwise</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_conversation_history_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">WiseAgentContext</span><span class="p">,</span>
                                       <span class="n">chat_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">collaboration_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span>
    <span class="n">ChatCompletionMessageParam</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the conversation history for the given chat id from the given context, depending on the</span>
<span class="sd">    type of collaboration the agent is involved in (i.e., sequential, phased, independent).</span>

<span class="sd">    Args:</span>
<span class="sd">        context (WiseAgentContext): the shared context</span>
<span class="sd">        chat_id (Optional[str]): the chat id, may be None</span>
<span class="sd">        collaboration_type (str): the type of collaboration this agent is involved in</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[ChatCompletionMessageParam]: the conversation history for the given chat id if the agent</span>
<span class="sd">        is involved in a collaboration type that makes use of the conversation history and an empty list</span>
<span class="sd">        otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">chat_id</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">collaboration_type</span> <span class="o">==</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">PHASED</span>
                <span class="ow">or</span> <span class="n">collaboration_type</span> <span class="o">==</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">CHAT</span><span class="p">):</span>
            <span class="c1"># this agent is involved in phased collaboration or a chat, so it needs the conversation history</span>
            <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">llm_chat_completion</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_id</span><span class="p">)</span>
    <span class="c1"># for sequential collaboration and independent agents, the shared history is not needed</span>
    <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.handle_request" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Callback method to handle the given request for this agent. This method optionally retrieves
conversation history from the shared context depending on the type of collaboration the agent
is involved in (i.e., sequential, phased, or independent) and passes this to the process_request
method. Finally, it handles the response from the process_request method, ensuring the shared
context is updated if necessary, and determines which agent to the send the response to, both
depending on the type of collaboration the agent is involved in.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>request</code></b>
                  (<code><a class="autorefs autorefs-internal" title="wiseagents.wise_agent_messaging.WiseAgentMessage" href="../wise_agent_messaging/#wiseagents.wise_agent_messaging.WiseAgentMessage">WiseAgentMessage</a></code>)
              
              <div class="doc-md-description">
                <p>the request message to be processed</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>bool</code>
              
              <div class="doc-md-description">
                <p>True if the message was processed successfully, False otherwise</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">handle_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Callback method to handle the given request for this agent. This method optionally retrieves</span>
<span class="sd">    conversation history from the shared context depending on the type of collaboration the agent</span>
<span class="sd">    is involved in (i.e., sequential, phased, or independent) and passes this to the process_request</span>
<span class="sd">    method. Finally, it handles the response from the process_request method, ensuring the shared</span>
<span class="sd">    context is updated if necessary, and determines which agent to the send the response to, both</span>
<span class="sd">    depending on the type of collaboration the agent is involved in.</span>

<span class="sd">    Args:</span>
<span class="sd">        request (WiseAgentMessage): the request message to be processed</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the message was processed successfully, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">context</span> <span class="o">=</span> <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">get_or_create_context</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">context_name</span><span class="p">)</span>
    <span class="n">collaboration_type</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get_collaboration_type</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">)</span>
    <span class="n">conversation_history</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_conversation_history_if_needed</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">,</span> <span class="n">collaboration_type</span><span class="p">)</span>
    <span class="n">response_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_request</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">conversation_history</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_response</span><span class="p">(</span><span class="n">response_str</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">collaboration_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.handle_response" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_response</span><span class="p">(</span><span class="n">response_str</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">collaboration_type</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Handles the given string response, ensuring the shared context is updated if necessary
and determines which agent to the send the response to, both depending on the type of
collaboration the agent is involved in (i.e., sequential, phased, or independent).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>response_str</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the string response to be handled</p>
              </div>
            </li>
            <li>
              <b><code>context</code></b>
                  (<code><a class="autorefs autorefs-internal" title="wiseagents.core.WiseAgentContext" href="#wiseagents.core.WiseAgentContext">WiseAgentContext</a></code>)
              
              <div class="doc-md-description">
                <p>the shared context</p>
              </div>
            </li>
            <li>
              <b><code>chat_id</code></b>
                  (<code><span title="typing.Optional">Optional</span>[str]</code>)
              
              <div class="doc-md-description">
                <p>the chat id, may be None</p>
              </div>
            </li>
            <li>
              <b><code>collaboration_type</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the type of collaboration this agent is involved in</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>bool</code>
              
              <div class="doc-md-description">
                <p>True if the message was processed successfully, False otherwise</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">handle_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">,</span>
                    <span class="n">context</span><span class="p">:</span> <span class="n">WiseAgentContext</span><span class="p">,</span> <span class="n">collaboration_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the given string response, ensuring the shared context is updated if necessary</span>
<span class="sd">    and determines which agent to the send the response to, both depending on the type of</span>
<span class="sd">    collaboration the agent is involved in (i.e., sequential, phased, or independent).</span>

<span class="sd">    Args:</span>
<span class="sd">        response_str (str): the string response to be handled</span>
<span class="sd">        context (WiseAgentContext): the shared context</span>
<span class="sd">        chat_id (Optional[str]): the chat id, may be None</span>
<span class="sd">        collaboration_type (str): the type of collaboration this agent is involved in</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the message was processed successfully, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">response_str</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">collaboration_type</span> <span class="o">==</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">PHASED</span>
                <span class="ow">or</span> <span class="n">collaboration_type</span> <span class="o">==</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">CHAT</span><span class="p">):</span>
            <span class="c1"># add this agent&#39;s response to the shared context</span>
            <span class="n">context</span><span class="o">.</span><span class="n">append_chat_completion</span><span class="p">(</span><span class="n">chat_uuid</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">,</span>
                                           <span class="n">messages</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;assistant&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">response_str</span><span class="p">})</span>

            <span class="c1"># let the sender know that this agent has finished processing the request</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span>
                <span class="n">WiseAgentMessage</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">response_str</span><span class="p">,</span> <span class="n">message_type</span><span class="o">=</span><span class="n">WiseAgentMessageType</span><span class="o">.</span><span class="n">ACK</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                 <span class="n">context_name</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                 <span class="n">chat_id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">),</span> <span class="n">request</span><span class="o">.</span><span class="n">sender</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">collaboration_type</span> <span class="o">==</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">SEQUENTIAL</span><span class="p">:</span>
            <span class="n">next_agent</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get_next_agent_in_sequence</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">next_agent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sequential coordination complete - sending response from &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; to &quot;</span>
                              <span class="o">+</span> <span class="n">context</span><span class="o">.</span><span class="n">get_route_response_to</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span><span class="n">WiseAgentMessage</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">response_str</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                    <span class="n">context_name</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">chat_id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">),</span>
                                   <span class="n">context</span><span class="o">.</span><span class="n">get_route_response_to</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sequential coordination continuing - sending response from &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
                              <span class="o">+</span> <span class="s2">&quot; to &quot;</span> <span class="o">+</span> <span class="n">next_agent</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">send_request</span><span class="p">(</span>
                    <span class="n">WiseAgentMessage</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">response_str</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">context_name</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                     <span class="n">chat_id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">),</span> <span class="n">next_agent</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span><span class="n">WiseAgentMessage</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">response_str</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                <span class="n">context_name</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">chat_id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">chat_id</span><span class="p">),</span>
                               <span class="n">request</span><span class="o">.</span><span class="n">sender</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.process_error" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_error</span><span class="p">(</span><span class="n">error</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Callback method to process the given error.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>error</code></b>
                  (<code>Exception</code>)
              
              <div class="doc-md-description">
                <p>the error to be processed</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>bool</code>
              
              <div class="doc-md-description">
                <p>True if the error was processed successfully, False otherwise</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">process_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Callback method to process the given error.</span>


<span class="sd">    Args:</span>
<span class="sd">        error (Exception): the error to be processed</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the error was processed successfully, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.process_event" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_event</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Callback method to process the given event.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>event</code></b>
                  (<code><a class="autorefs autorefs-internal" title="wiseagents.wise_agent_messaging.WiseAgentEvent" href="../wise_agent_messaging/#wiseagents.wise_agent_messaging.WiseAgentEvent">WiseAgentEvent</a></code>)
              
              <div class="doc-md-description">
                <p>the event to be processed</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>bool</code>
              
              <div class="doc-md-description">
                <p>True if the event was processed successfully, False otherwise</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">process_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">WiseAgentEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Callback method to process the given event.</span>


<span class="sd">    Args:</span>
<span class="sd">        event (WiseAgentEvent): the event to be processed</span>

<span class="sd">    Returns:</span>
<span class="sd">       True if the event was processed successfully, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.process_request" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_request</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">conversation_history</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Process the given request message to generate a response string.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>request</code></b>
                  (<code><a class="autorefs autorefs-internal" title="wiseagents.wise_agent_messaging.WiseAgentMessage" href="../wise_agent_messaging/#wiseagents.wise_agent_messaging.WiseAgentMessage">WiseAgentMessage</a></code>)
              
              <div class="doc-md-description">
                <p>the request message to be processed</p>
              </div>
            </li>
            <li>
              <b><code>conversation_history</code></b>
                  (<code><span title="typing.List">List</span>[<span title="openai.types.chat.ChatCompletionMessageParam">ChatCompletionMessageParam</span>]</code>)
              
              <div class="doc-md-description">
                <p>The conversation history that</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
              
              <div class="doc-md-description">
                <p>Optional[str]: the response to the request message as a string or None if there is</p>
              </div>
            </li>
            <li>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
              
              <div class="doc-md-description">
                <p>no string response yet</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">process_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">,</span>
                    <span class="n">conversation_history</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionMessageParam</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process the given request message to generate a response string.</span>

<span class="sd">    Args:</span>
<span class="sd">        request (WiseAgentMessage): the request message to be processed</span>
<span class="sd">        conversation_history (List[ChatCompletionMessageParam]): The conversation history that</span>
<span class="sd">        can be used while processing the request. If this agent isn&#39;t involved in a type of</span>
<span class="sd">        collaboration that makes use of the conversation history, this will be an empty list.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[str]: the response to the request message as a string or None if there is</span>
<span class="sd">        no string response yet</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.process_response" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_response</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Callback method to process the response received from another agent which processed a request from this agent.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>message</code></b>
                  (<code><a class="autorefs autorefs-internal" title="wiseagents.wise_agent_messaging.WiseAgentMessage" href="../wise_agent_messaging/#wiseagents.wise_agent_messaging.WiseAgentMessage">WiseAgentMessage</a></code>)
              
              <div class="doc-md-description">
                <p>the message to be processed</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>bool</code>
              
              <div class="doc-md-description">
                <p>True if the message was processed successfully, False otherwise</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">process_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Callback method to process the response received from another agent which processed a request from this agent.</span>


<span class="sd">    Args:</span>
<span class="sd">        message (WiseAgentMessage): the message to be processed</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the message was processed successfully, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.send_request" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">send_request</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">dest_agent_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Send a request message to the destination agent with the given name.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>message</code></b>
                  (<code><a class="autorefs autorefs-internal" title="wiseagents.wise_agent_messaging.WiseAgentMessage" href="../wise_agent_messaging/#wiseagents.wise_agent_messaging.WiseAgentMessage">WiseAgentMessage</a></code>)
              
              <div class="doc-md-description">
                <p>the message to send</p>
              </div>
            </li>
            <li>
              <b><code>dest_agent_name</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the name of the destination agent</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">send_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">,</span> <span class="n">dest_agent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Send a request message to the destination agent with the given name.</span>

<span class="sd">    Args:</span>
<span class="sd">        message (WiseAgentMessage): the message to send</span>
<span class="sd">        dest_agent_name (str): the name of the destination agent&#39;&#39;&#39;</span>
    <span class="n">message</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
    <span class="n">context</span> <span class="o">=</span> <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">get_or_create_context</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">context_name</span><span class="p">)</span>
    <span class="n">context</span><span class="o">.</span><span class="n">add_participant</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">send_request</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">dest_agent_name</span><span class="p">)</span>
    <span class="n">context</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.send_response" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">send_response</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">dest_agent_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Send a response message to the destination agent with the given name.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>message</code></b>
                  (<code><a class="autorefs autorefs-internal" title="wiseagents.wise_agent_messaging.WiseAgentMessage" href="../wise_agent_messaging/#wiseagents.wise_agent_messaging.WiseAgentMessage">WiseAgentMessage</a></code>)
              
              <div class="doc-md-description">
                <p>the message to send</p>
              </div>
            </li>
            <li>
              <b><code>dest_agent_name</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the name of the destination agent</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">send_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">,</span> <span class="n">dest_agent_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Send a response message to the destination agent with the given name.</span>

<span class="sd">    Args:</span>
<span class="sd">        message (WiseAgentMessage): the message to send</span>
<span class="sd">        dest_agent_name (str): the name of the destination agent&#39;&#39;&#39;</span>
    <span class="n">message</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
    <span class="n">context</span> <span class="o">=</span> <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">get_or_create_context</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">context_name</span><span class="p">)</span>
    <span class="n">context</span><span class="o">.</span><span class="n">add_participant</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">dest_agent_name</span><span class="p">)</span>
    <span class="n">context</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.start_agent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">start_agent</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Start the agent by setting the call backs and starting the transport.</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">start_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Start the agent by setting the call backs and starting the transport.&#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">set_call_backs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_event</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_error</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">process_response</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgent.stop_agent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stop_agent</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Stop the agent by stopping the transport and removing the agent from the registry.</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stop_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Stop the agent by stopping the transport and removing the agent from the registry.&#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">unregister_agent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="wiseagents.core.WiseAgentContext" class="doc doc-heading">
            <code>WiseAgentContext</code>


</h2>


    <div class="doc doc-contents ">


        <p>A WiseAgentContext is a class that represents a context in which agents can communicate with each other.</p>

              <details class="quote">
                <summary>Source code in <code>wiseagents/core.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">WiseAgentContext</span><span class="p">():</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39; A WiseAgentContext is a class that represents a context in which agents can communicate with each other.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">_message_trace</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_participants</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Maps a chat uuid to a list of chat completion messages</span>
    <span class="n">_llm_chat_completion</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionMessageParam</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Maps a chat uuid to a list of tool names that need to be executed</span>
    <span class="n">_llm_required_tool_call</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Maps a chat uuid to a list of available tools in chat</span>
    <span class="n">_llm_available_tools_in_chat</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionToolParam</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Maps a chat uuid to a list of agent names that need to be executed in sequence</span>
    <span class="c1"># Used by a sequential coordinator</span>
    <span class="n">_agents_sequence</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Maps a chat uuid to the agent where the final response should be routed to</span>
    <span class="c1"># Used by both a sequential coordinator and a phased coordinator</span>
    <span class="n">_route_response_to</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Maps a chat uuid to a list that contains a list of agent names to be executed for each phase</span>
    <span class="c1"># Used by a phased coordinator</span>
    <span class="n">_agent_phase_assignments</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Maps a chat uuid to the current phase. Used by a phased coordinator.</span>
    <span class="n">_current_phase</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Maps a chat uuid to a list of agent names that need to be executed for the current phase</span>
    <span class="c1"># Used by a phased coordinator</span>
    <span class="n">_required_agents_for_current_phase</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Maps a chat uuid to a list containing the queries attempted for each iteration executed by</span>
    <span class="c1"># the phased coordinator</span>
    <span class="n">_queries</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Maps a chat uuid to the collaboration type</span>
    <span class="n">_collaboration_type</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentCollaborationType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">_redis_db</span> <span class="p">:</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_use_redis</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">_config</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;use_redis&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39; Initialize the context with the given name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): the name of the context&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s2">&quot;redis_host&quot;</span><span class="p">],</span> <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s2">&quot;redis_port&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">register_context</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Return a string representation of the context.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, message_trace=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">message_trace</span><span class="si">}</span><span class="s2">,&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;participants=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">participants</span><span class="si">}</span><span class="s2">, llm_chat_completion=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">llm_chat_completion</span><span class="si">}</span><span class="s2">,&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;llm_required_tool_call=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">llm_required_tool_call</span><span class="si">}</span><span class="s2">, llm_available_tools_in_chat=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">llm_available_tools_in_chat</span><span class="si">}</span><span class="s2">,&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;agents_sequence=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_agents_sequence</span><span class="si">}</span><span class="s2">, route_response_to=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_route_response_to</span><span class="si">}</span><span class="s2">,&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;agent_phase_assignments=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_agent_phase_assignments</span><span class="si">}</span><span class="s2">, current_phase=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_phase</span><span class="si">}</span><span class="s2">,&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;required_agents_for_current_phase=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_required_agents_for_current_phase</span><span class="si">}</span><span class="s2">, queries=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">WiseAgentContext</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span> <span class="o">==</span> <span class="n">value</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Get the state of the context.&#39;&#39;&#39;</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="s1">&#39;_redis_db&#39;</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_redis_db&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_use_redis&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">object</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Set the state of the context.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s2">&quot;redis_host&quot;</span><span class="p">],</span> <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s2">&quot;redis_port&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="nd">@property</span>   
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of the context.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the message trace of the context.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">lrange</span><span class="p">(</span><span class="s2">&quot;message_trace&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_trace</span>

    <span class="k">def</span> <span class="nf">trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span> <span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Trace the message.&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">rpush</span><span class="p">(</span><span class="s2">&quot;message_trace&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message_trace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>   


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">participants</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the participants of the context.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">lrange</span><span class="p">(</span><span class="s2">&quot;participants&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_participants</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">llm_chat_completion</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionMessageParam</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the LLM chat completion of the context.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">return_dict</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionMessageParam</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">redis_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="s2">&quot;llm_chat_completion&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">redis_dict</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">return_dict</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_chat_completion</span>

    <span class="k">def</span> <span class="nf">add_participant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Add a participant to the context.</span>

<span class="sd">        Args:</span>
<span class="sd">            agent (WiseAgent): the agent to add&#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;participants&quot;</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;participants&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">rpush</span><span class="p">(</span><span class="s2">&quot;participants&quot;</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">)</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                        <span class="k">return</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">agent_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pipe</span><span class="o">.</span><span class="n">lrange</span><span class="p">(</span><span class="s2">&quot;participants&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                            <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                            <span class="n">pipe</span><span class="o">.</span><span class="n">rpush</span><span class="p">(</span><span class="s2">&quot;participants&quot;</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">)</span>
                            <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                            <span class="k">return</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">pipe</span><span class="o">.</span><span class="n">unwatch</span><span class="p">()</span>
                            <span class="k">return</span>
                <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;WatchError in add_participant&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">agent_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">participants</span><span class="p">:</span>    
                <span class="bp">self</span><span class="o">.</span><span class="n">_participants</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">append_chat_completion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">messages</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ChatCompletionMessageParam</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Append chat completion to the context.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            messages (Iterable[ChatCompletionMessageParam]): the messages to append&#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;llm_chat_completion&quot;</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;llm_chat_completion&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_chat_completion&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">([</span><span class="n">messages</span><span class="p">]))</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                        <span class="k">return</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">redis_stored_messages</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;llm_chat_completion&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
                        <span class="n">stored_messages</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionMessageParam</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_stored_messages</span><span class="p">)</span>
                        <span class="n">stored_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_chat_completion&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stored_messages</span><span class="p">))</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                        <span class="k">return</span>
                <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;WatchError in append_chat_completion&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_chat_completion</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_llm_chat_completion</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_llm_chat_completion</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">llm_required_tool_call</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the LLM required tool call of the context.</span>
<span class="sd">        return Dict[str, List[str]]&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">redis_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">)</span>
            <span class="n">return_dict</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">redis_dict</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">return_dict</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span>

    <span class="k">def</span> <span class="nf">append_required_tool_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Append required tool call to the context.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            tool_name (str): the tool name to append&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">([</span><span class="n">tool_name</span><span class="p">]))</span>
                <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">)</span>
                        <span class="n">redis_stored_tool_names</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
                        <span class="n">stored_tool_names</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_stored_tool_names</span><span class="p">)</span>
                        <span class="n">stored_tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stored_tool_names</span><span class="p">))</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                        <span class="k">break</span>
                    <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;WatchError in append_required_tool_call&quot;</span><span class="p">)</span>
                        <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">llm_required_tool_call</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_required_tool_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Remove required tool call from the context.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            tool_name (str): the tool name to remove&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">unwatch</span><span class="p">()</span>
                        <span class="k">return</span>
                    <span class="n">redis_stored_tool_names</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">redis_stored_tool_names</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
                        <span class="n">stored_tool_names</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">stored_tool_names</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_stored_tool_names</span><span class="p">)</span>
                        <span class="n">stored_tool_names</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stored_tool_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">hdel</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stored_tool_names</span><span class="p">))</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                    <span class="k">break</span>
                <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;WatchError in remove_required_tool_call&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_required_tool_calls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Get required tool calls from the context.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            return List[str]&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">llm_req_tools</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">llm_req_tools</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">llm_req_tools</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>   

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">llm_available_tools_in_chat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionToolParam</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the LLM available tools in chat of the context.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">redis_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="s2">&quot;llm_available_tools_in_chat&quot;</span><span class="p">)</span>
            <span class="n">return_dict</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionToolParam</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">redis_dict</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">return_dict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_available_tools_in_chat</span>

    <span class="k">def</span> <span class="nf">append_available_tool_in_chat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tools</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ChatCompletionToolParam</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Append available tool in chat to the context.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            tools (Iterable[ChatCompletionToolParam]): the tools to append&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;llm_available_tools_in_chat&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;llm_available_tools_in_chat&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>    
                        <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_available_tools_in_chat&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">([</span><span class="n">tools</span><span class="p">]))</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                        <span class="k">break</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">redis_stored_tools</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;llm_available_tools_in_chat&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
                        <span class="n">stored_tools</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionToolParam</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_stored_tools</span><span class="p">)</span>
                        <span class="n">stored_tools</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tools</span><span class="p">)</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_available_tools_in_chat&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stored_tools</span><span class="p">))</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                        <span class="k">break</span>
                <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;WatchError in append_available_tool_in_chat&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_available_tools_in_chat</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_llm_available_tools_in_chat</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_llm_available_tools_in_chat</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tools</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_available_tools_in_chat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionToolParam</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Get available tools in chat from the context.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            return List[ChatCompletionToolParam]&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">llm_av_tools</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;llm_available_tools_in_chat&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>   
            <span class="k">if</span> <span class="p">(</span><span class="n">llm_av_tools</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">llm_av_tools</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_available_tools_in_chat</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_available_tools_in_chat</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">get_agents_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the sequence of agents for the given chat uuid for this context. This is used by a sequential</span>
<span class="sd">        coordinator to execute its agents in a specific order, passing the output from one agent in the sequence</span>
<span class="sd">        to the next agent in the sequence.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[str]: the sequence of agents names or an empty list if no sequence has been set for this context</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">agent_sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;agents_sequence&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">agent_sequence</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">agent_sequence</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agents_sequence</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agents_sequence</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">set_agents_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">agents_sequence</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the sequence of agents for the given chat uuid for this context. This is used by</span>
<span class="sd">        a sequential coordinator to execute its agents in a specific order, passing the output</span>
<span class="sd">        from one agent in the sequence to the next agent in the sequence.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            agents_sequence (List[str]): the sequence of agent names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;agents_sequence&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">agents_sequence</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_agents_sequence</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">agents_sequence</span>

    <span class="k">def</span> <span class="nf">get_route_response_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the name of the agent where the final response should be routed to for the given chat uuid for this</span>
<span class="sd">        context. This is used by a sequential coordinator and a phased coordinator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Optional[str]: the name of the agent where the final response should be routed to or None if no agent is set</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">route</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;route_response_to&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">route</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_route_response_to</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_route_response_to</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">set_route_response_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">agent</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the name of the agent where the final response should be routed to for the given chat uuid for this</span>
<span class="sd">        context. This is used by a sequential coordinator and a phased coordinator.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            agent (str): the name of the agent where the final response should be routed to</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;route_response_to&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">agent</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_route_response_to</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent</span>

    <span class="k">def</span> <span class="nf">get_next_agent_in_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">current_agent</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the name of the next agent in the sequence of agents for the given chat uuid for this context.</span>
<span class="sd">        This is used by a sequential coordinator to determine the name of the next agent to execute.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            current_agent (str): the name of the current agent</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: the name of the next agent in the sequence after the current agent or None if there are no remaining</span>
<span class="sd">            agents in the sequence after the current agent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">agents_sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_agents_sequence</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">current_agent</span> <span class="ow">in</span> <span class="n">agents_sequence</span><span class="p">:</span>
            <span class="n">current_agent_index</span> <span class="o">=</span> <span class="n">agents_sequence</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current_agent</span><span class="p">)</span>
            <span class="n">next_agent_index</span> <span class="o">=</span> <span class="n">current_agent_index</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">next_agent_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">agents_sequence</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">agents_sequence</span><span class="p">[</span><span class="n">next_agent_index</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">get_agent_phase_assignments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the agents to be executed in each phase for the given chat uuid for this context. This is used</span>
<span class="sd">        by a phased coordinator.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[List[str]]: The agents to be executed in each phase, represented as a list of lists, where the</span>
<span class="sd">            size of the outer list corresponds to the number of phases and each element in the list is a list of</span>
<span class="sd">            agent names for that phase. An empty list is returned if no phases have been set for the</span>
<span class="sd">            given chat uuid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">agent_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;agent_phase_assignments&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">agent_phase</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">agent_phase</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agent_phase_assignments</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agent_phase_assignments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">set_agent_phase_assignments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">agent_phase_assignments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the agents to be executed in each phase for the given chat uuid for this context. This is used</span>
<span class="sd">        by a phased coordinator.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            agent_phase_assignments (List[List[str]]): The agents to be executed in each phase, represented as a</span>
<span class="sd">            list of lists, where the size of the outer list corresponds to the number of phases and each element</span>
<span class="sd">            in the list is a list of agent names for that phase.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;agent_phase_assignments&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">agent_phase_assignments</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_agent_phase_assignments</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent_phase_assignments</span>

    <span class="k">def</span> <span class="nf">get_current_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the current phase for the given chat uuid for this context. This is used by a phased coordinator.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: the current phase, represented as an integer in the zero-indexed list of phases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">cur_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">cur_phase</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">cur_phase</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_phase</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_current_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">phase</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the current phase for the given chat uuid for this context. This method also</span>
<span class="sd">        sets the required agents for the current phase. This is used by a phased coordinator.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            phase (int): the current phase, represented as an integer in the zero-indexed list of phases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>\
                <span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">phase</span><span class="p">))</span>\
                <span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_agent_phase_assignments</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)[</span><span class="n">phase</span><span class="p">]))</span>\
                <span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current_phase</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">phase</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_required_agents_for_current_phase</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_agent_phase_assignments</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">][</span><span class="n">phase</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">get_agents_for_next_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of agents to be executed for the next phase for the given chat uuid for this context.</span>
<span class="sd">        This is used by a phased coordinator.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>

<span class="sd">        Returns:</span>
<span class="sd">            Optional[List[str]]: the list of agent names for the next phase or None if there are no more phases</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_phase</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="n">next_phase</span> <span class="o">=</span> <span class="n">current_phase</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">next_phase</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_agent_phase_assignments</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_current_phase</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">next_phase</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_agent_phase_assignments</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)[</span><span class="n">next_phase</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">get_required_agents_for_current_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of agents that still need to be executed for the current phase for the given chat uuid for this</span>
<span class="sd">        context. This is used by a phased coordinator.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[str]: the list of agent names that still need to be executed for the current phase or an empty list</span>
<span class="sd">            if there are no remaining agents that need to be executed for the current phase</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">req_agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">req_agent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">req_agent</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_required_agents_for_current_phase</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_required_agents_for_current_phase</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">remove_required_agent_for_current_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the given agent from the list of required agents for the current phase for the given chat uuid for this</span>
<span class="sd">        context. This is used by a phased coordinator.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            agent_name (str): the name of the agent to remove</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">unwatch</span><span class="p">()</span>
                        <span class="k">return</span>
                    <span class="n">redis_stored_agents</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
                    <span class="n">stored_agents</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_stored_agents</span><span class="p">)</span>
                    <span class="n">stored_agents</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stored_agents</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">hdel</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stored_agents</span><span class="p">))</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                    <span class="k">break</span>
                <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;WatchError: Retrying to remove agent&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_required_agents_for_current_phase</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_required_agents_for_current_phase</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_current_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the current query for the given chat uuid for this context. This is used by a phased coordinator.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>

<span class="sd">        Returns:</span>
<span class="sd">            Optional[str]: the current query or None if there is no current query</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">queries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">queries</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">return_list</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">queries</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">return_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">):</span>
                    <span class="c1"># return the last query</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">add_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add the current query for the given chat uuid for this context. This is used by a phased coordinator.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            query (str): the current query</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">([</span><span class="n">query</span><span class="p">]))</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">redis_stored_queries</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
                        <span class="n">stored_queries</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_stored_queries</span><span class="p">)</span>
                        <span class="n">stored_queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stored_queries</span><span class="p">))</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                    <span class="k">break</span>
                <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;WatchError: Retrying to add query&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_queries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the queries attempted for the given chat uuid for this context. This is used by a phased coordinator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[str]: the queries attempted for the given chat uuid for this context</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">query</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">collaboration_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentCollaborationType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the collaboration type for chat uuids for this context.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">return_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentCollaborationType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">redis_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="s2">&quot;collaboration_type&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">redis_dict</span><span class="p">:</span>
                <span class="n">return_dict</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">return_dict</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collaboration_type</span>

    <span class="k">def</span> <span class="nf">get_collaboration_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WiseAgentCollaborationType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the collaboration type for the given chat uuid for this context.</span>
<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (Optional[str]): the chat uuid, may be None</span>
<span class="sd">        Returns:</span>
<span class="sd">            WiseAgentCollaborationType: the collaboration type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">collaboration_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;collaboration_type&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">collaboration_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">collaboration_type</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">INDEPENDENT</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collaboration_type</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collaboration_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">INDEPENDENT</span>

    <span class="k">def</span> <span class="nf">set_collaboration_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">collaboration_type</span><span class="p">:</span> <span class="n">WiseAgentCollaborationType</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the collaboration type for the given chat uuid for this context.</span>

<span class="sd">        Args:</span>
<span class="sd">            chat_uuid (str): the chat uuid</span>
<span class="sd">            collaboration_type (WiseAgentCollaborationType): the collaboration type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;collaboration_type&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">collaboration_type</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collaboration_type</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">collaboration_type</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgentContext.collaboration_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">collaboration_type</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentCollaborationType</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the collaboration type for chat uuids for this context.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgentContext.llm_available_tools_in_chat" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">llm_available_tools_in_chat</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionToolParam</span><span class="p">]]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the LLM available tools in chat of the context.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgentContext.llm_chat_completion" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">llm_chat_completion</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionMessageParam</span><span class="p">]]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the LLM chat completion of the context.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgentContext.llm_required_tool_call" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">llm_required_tool_call</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the LLM required tool call of the context.
return Dict[str, List[str]]</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgentContext.message_trace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">message_trace</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the message trace of the context.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgentContext.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the name of the context.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgentContext.participants" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">participants</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the participants of the context.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.__getstate__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__getstate__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the state of the context.</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Get the state of the context.&#39;&#39;&#39;</span>
    <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;_redis_db&#39;</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_redis_db&#39;</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_use_redis&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">state</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_redis&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the context with the given name.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>name</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the name of the context</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;use_redis&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Initialize the context with the given name.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): the name of the context&#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s2">&quot;redis_host&quot;</span><span class="p">],</span> <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s2">&quot;redis_port&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">register_context</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a string representation of the context.</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Return a string representation of the context.&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, message_trace=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">message_trace</span><span class="si">}</span><span class="s2">,&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;participants=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">participants</span><span class="si">}</span><span class="s2">, llm_chat_completion=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">llm_chat_completion</span><span class="si">}</span><span class="s2">,&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;llm_required_tool_call=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">llm_required_tool_call</span><span class="si">}</span><span class="s2">, llm_available_tools_in_chat=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">llm_available_tools_in_chat</span><span class="si">}</span><span class="s2">,&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;agents_sequence=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_agents_sequence</span><span class="si">}</span><span class="s2">, route_response_to=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_route_response_to</span><span class="si">}</span><span class="s2">,&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;agent_phase_assignments=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_agent_phase_assignments</span><span class="si">}</span><span class="s2">, current_phase=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_phase</span><span class="si">}</span><span class="s2">,&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;required_agents_for_current_phase=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_required_agents_for_current_phase</span><span class="si">}</span><span class="s2">, queries=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.__setstate__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the state of the context.</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Set the state of the context.&#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s2">&quot;redis_host&quot;</span><span class="p">],</span> <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s2">&quot;redis_port&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.add_participant" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_participant</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add a participant to the context.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>agent</code></b>
                  (<code><a class="autorefs autorefs-internal" title="wiseagents.core.WiseAgent" href="#wiseagents.core.WiseAgent">WiseAgent</a></code>)
              
              <div class="doc-md-description">
                <p>the agent to add</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_participant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Add a participant to the context.</span>

<span class="sd">    Args:</span>
<span class="sd">        agent (WiseAgent): the agent to add&#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;participants&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span><span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;participants&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">rpush</span><span class="p">(</span><span class="s2">&quot;participants&quot;</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">)</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">agent_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pipe</span><span class="o">.</span><span class="n">lrange</span><span class="p">(</span><span class="s2">&quot;participants&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">rpush</span><span class="p">(</span><span class="s2">&quot;participants&quot;</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">)</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                        <span class="k">return</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">unwatch</span><span class="p">()</span>
                        <span class="k">return</span>
            <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;WatchError in add_participant&quot;</span><span class="p">)</span>
                <span class="k">continue</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">agent_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">participants</span><span class="p">:</span>    
            <span class="bp">self</span><span class="o">.</span><span class="n">_participants</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.add_query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_query</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add the current query for the given chat uuid for this context. This is used by a phased coordinator.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
            <li>
              <b><code>query</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the current query</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add the current query for the given chat uuid for this context. This is used by a phased coordinator.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        query (str): the current query</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">([</span><span class="n">query</span><span class="p">]))</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">redis_stored_queries</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
                    <span class="n">stored_queries</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_stored_queries</span><span class="p">)</span>
                    <span class="n">stored_queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stored_queries</span><span class="p">))</span>
                <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;WatchError: Retrying to add query&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.append_available_tool_in_chat" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">append_available_tool_in_chat</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">tools</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Append available tool in chat to the context.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
            <li>
              <b><code>tools</code></b>
                  (<code><span title="typing.Iterable">Iterable</span>[<span title="openai.types.chat.ChatCompletionToolParam">ChatCompletionToolParam</span>]</code>)
              
              <div class="doc-md-description">
                <p>the tools to append</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">append_available_tool_in_chat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tools</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ChatCompletionToolParam</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Append available tool in chat to the context.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        tools (Iterable[ChatCompletionToolParam]): the tools to append&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;llm_available_tools_in_chat&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;llm_available_tools_in_chat&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>    
                    <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_available_tools_in_chat&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">([</span><span class="n">tools</span><span class="p">]))</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                    <span class="k">break</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">redis_stored_tools</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;llm_available_tools_in_chat&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
                    <span class="n">stored_tools</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionToolParam</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_stored_tools</span><span class="p">)</span>
                    <span class="n">stored_tools</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tools</span><span class="p">)</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_available_tools_in_chat&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stored_tools</span><span class="p">))</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                    <span class="k">break</span>
            <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;WatchError in append_available_tool_in_chat&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_available_tools_in_chat</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_llm_available_tools_in_chat</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_llm_available_tools_in_chat</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tools</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.append_chat_completion" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">append_chat_completion</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">messages</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Append chat completion to the context.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
            <li>
              <b><code>messages</code></b>
                  (<code><span title="typing.Iterable">Iterable</span>[<span title="openai.types.chat.ChatCompletionMessageParam">ChatCompletionMessageParam</span>]</code>)
              
              <div class="doc-md-description">
                <p>the messages to append</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">append_chat_completion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">messages</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ChatCompletionMessageParam</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Append chat completion to the context.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        messages (Iterable[ChatCompletionMessageParam]): the messages to append&#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;llm_chat_completion&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span><span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;llm_chat_completion&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_chat_completion&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">([</span><span class="n">messages</span><span class="p">]))</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">redis_stored_messages</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;llm_chat_completion&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
                    <span class="n">stored_messages</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionMessageParam</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_stored_messages</span><span class="p">)</span>
                    <span class="n">stored_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_chat_completion&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stored_messages</span><span class="p">))</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                    <span class="k">return</span>
            <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;WatchError in append_chat_completion&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_chat_completion</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_llm_chat_completion</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_llm_chat_completion</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.append_required_tool_call" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">append_required_tool_call</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Append required tool call to the context.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
            <li>
              <b><code>tool_name</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the tool name to append</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">append_required_tool_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Append required tool call to the context.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        tool_name (str): the tool name to append&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">([</span><span class="n">tool_name</span><span class="p">]))</span>
            <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">)</span>
                    <span class="n">redis_stored_tool_names</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
                    <span class="n">stored_tool_names</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_stored_tool_names</span><span class="p">)</span>
                    <span class="n">stored_tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stored_tool_names</span><span class="p">))</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                    <span class="k">break</span>
                <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;WatchError in append_required_tool_call&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">llm_required_tool_call</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.get_agent_phase_assignments" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_agent_phase_assignments</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the agents to be executed in each phase for the given chat uuid for this context. This is used
by a phased coordinator.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[str]]</code>
              
              <div class="doc-md-description">
                <p>List[List[str]]: The agents to be executed in each phase, represented as a list of lists, where the</p>
              </div>
            </li>
            <li>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[str]]</code>
              
              <div class="doc-md-description">
                <p>size of the outer list corresponds to the number of phases and each element in the list is a list of</p>
              </div>
            </li>
            <li>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[str]]</code>
              
              <div class="doc-md-description">
                <p>agent names for that phase. An empty list is returned if no phases have been set for the</p>
              </div>
            </li>
            <li>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[str]]</code>
              
              <div class="doc-md-description">
                <p>given chat uuid</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_agent_phase_assignments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the agents to be executed in each phase for the given chat uuid for this context. This is used</span>
<span class="sd">    by a phased coordinator.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[List[str]]: The agents to be executed in each phase, represented as a list of lists, where the</span>
<span class="sd">        size of the outer list corresponds to the number of phases and each element in the list is a list of</span>
<span class="sd">        agent names for that phase. An empty list is returned if no phases have been set for the</span>
<span class="sd">        given chat uuid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">agent_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;agent_phase_assignments&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">agent_phase</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">agent_phase</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agent_phase_assignments</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agent_phase_assignments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.get_agents_for_next_phase" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_agents_for_next_phase</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the list of agents to be executed for the next phase for the given chat uuid for this context.
This is used by a phased coordinator.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>]</code>
              
              <div class="doc-md-description">
                <p>Optional[List[str]]: the list of agent names for the next phase or None if there are no more phases</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_agents_for_next_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the list of agents to be executed for the next phase for the given chat uuid for this context.</span>
<span class="sd">    This is used by a phased coordinator.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[List[str]]: the list of agent names for the next phase or None if there are no more phases</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">current_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_phase</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
    <span class="n">next_phase</span> <span class="o">=</span> <span class="n">current_phase</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">next_phase</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_agent_phase_assignments</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_current_phase</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">next_phase</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_agent_phase_assignments</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)[</span><span class="n">next_phase</span><span class="p">]</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.get_agents_sequence" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_agents_sequence</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the sequence of agents for the given chat uuid for this context. This is used by a sequential
coordinator to execute its agents in a specific order, passing the output from one agent in the sequence
to the next agent in the sequence.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[str]</code>
              
              <div class="doc-md-description">
                <p>List[str]: the sequence of agents names or an empty list if no sequence has been set for this context</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_agents_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the sequence of agents for the given chat uuid for this context. This is used by a sequential</span>
<span class="sd">    coordinator to execute its agents in a specific order, passing the output from one agent in the sequence</span>
<span class="sd">    to the next agent in the sequence.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: the sequence of agents names or an empty list if no sequence has been set for this context</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">agent_sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;agents_sequence&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">agent_sequence</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">agent_sequence</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agents_sequence</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agents_sequence</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.get_available_tools_in_chat" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_available_tools_in_chat</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get available tools in chat from the context.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_available_tools_in_chat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatCompletionToolParam</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Get available tools in chat from the context.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        return List[ChatCompletionToolParam]&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">llm_av_tools</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;llm_available_tools_in_chat&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>   
        <span class="k">if</span> <span class="p">(</span><span class="n">llm_av_tools</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">llm_av_tools</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_available_tools_in_chat</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_available_tools_in_chat</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.get_collaboration_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_collaboration_type</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the collaboration type for the given chat uuid for this context.
Args:
    chat_uuid (Optional[str]): the chat uuid, may be None
Returns:
    WiseAgentCollaborationType: the collaboration type</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_collaboration_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WiseAgentCollaborationType</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the collaboration type for the given chat uuid for this context.</span>
<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (Optional[str]): the chat uuid, may be None</span>
<span class="sd">    Returns:</span>
<span class="sd">        WiseAgentCollaborationType: the collaboration type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">collaboration_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;collaboration_type&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">collaboration_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">collaboration_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">INDEPENDENT</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collaboration_type</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collaboration_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">WiseAgentCollaborationType</span><span class="o">.</span><span class="n">INDEPENDENT</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.get_current_phase" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_current_phase</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the current phase for the given chat uuid for this context. This is used by a phased coordinator.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>int</code></b>(                  <code>int</code>
)              
              <div class="doc-md-description">
                <p>the current phase, represented as an integer in the zero-indexed list of phases</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_current_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the current phase for the given chat uuid for this context. This is used by a phased coordinator.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: the current phase, represented as an integer in the zero-indexed list of phases</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">cur_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">cur_phase</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">cur_phase</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_phase</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.get_current_query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_current_query</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the current query for the given chat uuid for this context. This is used by a phased coordinator.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
              
              <div class="doc-md-description">
                <p>Optional[str]: the current query or None if there is no current query</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_current_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the current query for the given chat uuid for this context. This is used by a phased coordinator.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[str]: the current query or None if there is no current query</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">queries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">queries</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">return_list</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">queries</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">return_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">):</span>
                <span class="c1"># return the last query</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.get_next_agent_in_sequence" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_next_agent_in_sequence</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">current_agent</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the name of the next agent in the sequence of agents for the given chat uuid for this context.
This is used by a sequential coordinator to determine the name of the next agent to execute.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
            <li>
              <b><code>current_agent</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the name of the current agent</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>str</code></b>              
              <div class="doc-md-description">
                <p>the name of the next agent in the sequence after the current agent or None if there are no remaining</p>
              </div>
            </li>
            <li>
              
              <div class="doc-md-description">
                <p>agents in the sequence after the current agent</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_next_agent_in_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">current_agent</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the name of the next agent in the sequence of agents for the given chat uuid for this context.</span>
<span class="sd">    This is used by a sequential coordinator to determine the name of the next agent to execute.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        current_agent (str): the name of the current agent</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the name of the next agent in the sequence after the current agent or None if there are no remaining</span>
<span class="sd">        agents in the sequence after the current agent</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">agents_sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_agents_sequence</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">current_agent</span> <span class="ow">in</span> <span class="n">agents_sequence</span><span class="p">:</span>
        <span class="n">current_agent_index</span> <span class="o">=</span> <span class="n">agents_sequence</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">current_agent</span><span class="p">)</span>
        <span class="n">next_agent_index</span> <span class="o">=</span> <span class="n">current_agent_index</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">next_agent_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">agents_sequence</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">agents_sequence</span><span class="p">[</span><span class="n">next_agent_index</span><span class="p">]</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.get_queries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_queries</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the queries attempted for the given chat uuid for this context. This is used by a phased coordinator.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[str]</code>
              
              <div class="doc-md-description">
                <p>List[str]: the queries attempted for the given chat uuid for this context</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_queries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the queries attempted for the given chat uuid for this context. This is used by a phased coordinator.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: the queries attempted for the given chat uuid for this context</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;queries&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">query</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.get_required_agents_for_current_phase" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_required_agents_for_current_phase</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the list of agents that still need to be executed for the current phase for the given chat uuid for this
context. This is used by a phased coordinator.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[str]</code>
              
              <div class="doc-md-description">
                <p>List[str]: the list of agent names that still need to be executed for the current phase or an empty list</p>
              </div>
            </li>
            <li>
                  <code><span title="typing.List">List</span>[str]</code>
              
              <div class="doc-md-description">
                <p>if there are no remaining agents that need to be executed for the current phase</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_required_agents_for_current_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the list of agents that still need to be executed for the current phase for the given chat uuid for this</span>
<span class="sd">    context. This is used by a phased coordinator.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: the list of agent names that still need to be executed for the current phase or an empty list</span>
<span class="sd">        if there are no remaining agents that need to be executed for the current phase</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">req_agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">req_agent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">req_agent</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_required_agents_for_current_phase</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_required_agents_for_current_phase</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.get_required_tool_calls" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_required_tool_calls</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get required tool calls from the context.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_required_tool_calls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Get required tool calls from the context.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        return List[str]&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">llm_req_tools</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">llm_req_tools</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">llm_req_tools</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>   
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.get_route_response_to" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_route_response_to</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the name of the agent where the final response should be routed to for the given chat uuid for this
context. This is used by a sequential coordinator and a phased coordinator.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
              
              <div class="doc-md-description">
                <p>Optional[str]: the name of the agent where the final response should be routed to or None if no agent is set</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_route_response_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the name of the agent where the final response should be routed to for the given chat uuid for this</span>
<span class="sd">    context. This is used by a sequential coordinator and a phased coordinator.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[str]: the name of the agent where the final response should be routed to or None if no agent is set</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">route</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;route_response_to&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">route</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_route_response_to</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_route_response_to</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.remove_required_agent_for_current_phase" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_required_agent_for_current_phase</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove the given agent from the list of required agents for the current phase for the given chat uuid for this
context. This is used by a phased coordinator.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
            <li>
              <b><code>agent_name</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the name of the agent to remove</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_required_agent_for_current_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove the given agent from the list of required agents for the current phase for the given chat uuid for this</span>
<span class="sd">    context. This is used by a phased coordinator.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        agent_name (str): the name of the agent to remove</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">unwatch</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="n">redis_stored_agents</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
                <span class="n">stored_agents</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_stored_agents</span><span class="p">)</span>
                <span class="n">stored_agents</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span>
                <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stored_agents</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">hdel</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stored_agents</span><span class="p">))</span>
                <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;WatchError: Retrying to remove agent&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_required_agents_for_current_phase</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_required_agents_for_current_phase</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.remove_required_tool_call" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_required_tool_call</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove required tool call from the context.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
            <li>
              <b><code>tool_name</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the tool name to remove</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_required_tool_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Remove required tool call from the context.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        tool_name (str): the tool name to remove&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">unwatch</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="n">redis_stored_tool_names</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">redis_stored_tool_names</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="n">stored_tool_names</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stored_tool_names</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">redis_stored_tool_names</span><span class="p">)</span>
                    <span class="n">stored_tool_names</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
                <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stored_tool_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">hdel</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;llm_required_tool_call&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stored_tool_names</span><span class="p">))</span>
                <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;WatchError in remove_required_tool_call&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
    <span class="k">if</span> <span class="n">chat_uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_llm_required_tool_call</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.set_agent_phase_assignments" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_agent_phase_assignments</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">agent_phase_assignments</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the agents to be executed in each phase for the given chat uuid for this context. This is used
by a phased coordinator.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
            <li>
              <b><code>agent_phase_assignments</code></b>
                  (<code><span title="typing.List">List</span>[<span title="typing.List">List</span>[str]]</code>)
              
              <div class="doc-md-description">
                <p>The agents to be executed in each phase, represented as a</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_agent_phase_assignments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">agent_phase_assignments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the agents to be executed in each phase for the given chat uuid for this context. This is used</span>
<span class="sd">    by a phased coordinator.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        agent_phase_assignments (List[List[str]]): The agents to be executed in each phase, represented as a</span>
<span class="sd">        list of lists, where the size of the outer list corresponds to the number of phases and each element</span>
<span class="sd">        in the list is a list of agent names for that phase.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;agent_phase_assignments&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">agent_phase_assignments</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_agent_phase_assignments</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent_phase_assignments</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.set_agents_sequence" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_agents_sequence</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">agents_sequence</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the sequence of agents for the given chat uuid for this context. This is used by
a sequential coordinator to execute its agents in a specific order, passing the output
from one agent in the sequence to the next agent in the sequence.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
            <li>
              <b><code>agents_sequence</code></b>
                  (<code><span title="typing.List">List</span>[str]</code>)
              
              <div class="doc-md-description">
                <p>the sequence of agent names</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_agents_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">agents_sequence</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the sequence of agents for the given chat uuid for this context. This is used by</span>
<span class="sd">    a sequential coordinator to execute its agents in a specific order, passing the output</span>
<span class="sd">    from one agent in the sequence to the next agent in the sequence.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        agents_sequence (List[str]): the sequence of agent names</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;agents_sequence&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">agents_sequence</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_agents_sequence</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">agents_sequence</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.set_collaboration_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_collaboration_type</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">collaboration_type</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the collaboration type for the given chat uuid for this context.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
            <li>
              <b><code>collaboration_type</code></b>
                  (<code><span title="wiseagents.core.WiseAgentCollaborationType">WiseAgentCollaborationType</span></code>)
              
              <div class="doc-md-description">
                <p>the collaboration type</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_collaboration_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">collaboration_type</span><span class="p">:</span> <span class="n">WiseAgentCollaborationType</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the collaboration type for the given chat uuid for this context.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        collaboration_type (WiseAgentCollaborationType): the collaboration type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;collaboration_type&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">collaboration_type</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collaboration_type</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">collaboration_type</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.set_current_phase" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_current_phase</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the current phase for the given chat uuid for this context. This method also
sets the required agents for the current phase. This is used by a phased coordinator.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
            <li>
              <b><code>phase</code></b>
                  (<code>int</code>)
              
              <div class="doc-md-description">
                <p>the current phase, represented as an integer in the zero-indexed list of phases</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_current_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">phase</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the current phase for the given chat uuid for this context. This method also</span>
<span class="sd">    sets the required agents for the current phase. This is used by a phased coordinator.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        phase (int): the current phase, represented as an integer in the zero-indexed list of phases</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>\
            <span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">phase</span><span class="p">))</span>\
            <span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;required_agents_for_current_phase&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_agent_phase_assignments</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">)[</span><span class="n">phase</span><span class="p">]))</span>\
            <span class="o">.</span><span class="n">execute</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_phase</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">phase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_required_agents_for_current_phase</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_agent_phase_assignments</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">][</span><span class="n">phase</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.set_route_response_to" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_route_response_to</span><span class="p">(</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">agent</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the name of the agent where the final response should be routed to for the given chat uuid for this
context. This is used by a sequential coordinator and a phased coordinator.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>chat_uuid</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the chat uuid</p>
              </div>
            </li>
            <li>
              <b><code>agent</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the name of the agent where the final response should be routed to</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_route_response_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chat_uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">agent</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the name of the agent where the final response should be routed to for the given chat uuid for this</span>
<span class="sd">    context. This is used by a sequential coordinator and a phased coordinator.</span>

<span class="sd">    Args:</span>
<span class="sd">        chat_uuid (str): the chat uuid</span>
<span class="sd">        agent (str): the name of the agent where the final response should be routed to</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;route_response_to&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chat_uuid</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">agent</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_route_response_to</span><span class="p">[</span><span class="n">chat_uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentContext.trace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trace</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Trace the message.</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span> <span class="p">:</span> <span class="n">WiseAgentMessage</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Trace the message.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_use_redis</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redis_db</span><span class="o">.</span><span class="n">rpush</span><span class="p">(</span><span class="s2">&quot;message_trace&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_trace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>   
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="wiseagents.core.WiseAgentRegistry" class="doc doc-heading">
            <code>WiseAgentRegistry</code>


</h2>


    <div class="doc doc-contents ">


        <p>A Registry to get available agents and running contexts</p>

              <details class="quote">
                <summary>Source code in <code>wiseagents/core.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">WiseAgentRegistry</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Registry to get available agents and running contexts</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">agents_descriptions_dict</span> <span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">contexts</span> <span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentContext</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">tools</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentTool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">redis_db</span> <span class="p">:</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">find_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">config_directory</span><span class="o">=</span><span class="s2">&quot;.wise-agents&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the file in the current directory or the home directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Step 1: Check the current directory</span>
        <span class="n">local_path</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">config_directory</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">local_path</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">local_path</span>

        <span class="c1"># Step 2: Check the home directory</span>
        <span class="n">home_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
        <span class="n">home_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">home_dir</span><span class="p">,</span> <span class="n">config_directory</span><span class="p">,</span><span class="n">file_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">home_path</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">home_path</span>

        <span class="c1"># If the file is not found in any of these locations, throw an exception</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&#39; not found in current directory, home directory, as &#39;</span><span class="si">{</span><span class="n">config_directory</span><span class="si">}</span><span class="s2">&#39;/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the configuration and initialize the redis database</span>
<span class="sd">        for more information see </span>
<span class="sd">        https://wise-agents.github.io/wise_agents_architecture/#distributed-architecture</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span> 
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">cls</span><span class="o">.</span><span class="n">config</span> <span class="o">==</span> <span class="p">{}:</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">find_file</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;registry_config.yaml&quot;</span><span class="p">,</span> <span class="n">config_directory</span><span class="o">=</span><span class="s2">&quot;.wise-agents&quot;</span><span class="p">)</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">config</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">),</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">and</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;redis_ssl&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">):</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span>
                    <span class="n">host</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_host&quot;</span><span class="p">],</span> <span class="n">port</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_port&quot;</span><span class="p">],</span>
                    <span class="n">username</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_username&quot;</span><span class="p">],</span> <span class="c1"># use your Redis user. More info https://redis.io/docs/latest/operate/oss_and_stack/management/security/acl/</span>
                    <span class="n">password</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_password&quot;</span><span class="p">],</span> <span class="c1"># use your Redis password</span>
                    <span class="n">ssl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">ssl_certfile</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_ssl_certfile&quot;</span><span class="p">],</span>
                    <span class="n">ssl_keyfile</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_ssl_keyfile&quot;</span><span class="p">],</span>
                    <span class="n">ssl_ca_certs</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_ssl_ca_certs&quot;</span><span class="p">])</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_host&quot;</span><span class="p">],</span> <span class="n">port</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_port&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">config</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">register_agent</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">agent_name</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">agent_description</span> <span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register an agent with the registry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">pipe</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">unwatch</span><span class="p">()</span>
                        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Agent with name </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2"> already exists&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">agent_name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">agent_description</span><span class="p">)</span>
                        <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;WatchError in register_agent&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">agents_descriptions_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Agent with name </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2"> already exists&quot;</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">agents_descriptions_dict</span><span class="p">[</span><span class="n">agent_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent_description</span>
    <span class="nd">@classmethod</span>    
    <span class="k">def</span> <span class="nf">register_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span> <span class="p">:</span> <span class="n">WiseAgentContext</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a context with the registry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;contexts&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">context</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">contexts</span><span class="p">[</span><span class="n">context</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>
    <span class="nd">@classmethod</span>    
    <span class="k">def</span> <span class="nf">fetch_agents_descriptions_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the dict with the agent names as keys and descriptions as values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">agents_descriptions_dict</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_contexts</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentContext</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of contexts</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">dictionary</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="s2">&quot;contexts&quot;</span><span class="p">)</span>
            <span class="n">return_dictionary</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentContext</span><span class="p">]</span><span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
                 <span class="n">return_dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">return_dictionary</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">contexts</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_agent_description</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the agent description for the agent with the given name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">return_byte</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">agent_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">return_byte</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">return_byte</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">agents_descriptions_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span> 

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_or_create_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WiseAgentContext</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get the context with the given name &quot;&quot;&quot;</span>
        <span class="n">context</span> <span class="p">:</span> <span class="n">WiseAgentContext</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">ctx</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;contexts&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">context_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ctx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">context</span> <span class="p">:</span> <span class="n">WiseAgentContext</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">context</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">contexts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">context_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># context creation will also register the context in the registry</span>
            <span class="k">return</span> <span class="n">WiseAgentContext</span><span class="p">(</span><span class="n">context_name</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">context</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">does_context_exist</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the context with the given name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;contexts&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">context_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span>  <span class="bp">cls</span><span class="o">.</span><span class="n">contexts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">context_name</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">unregister_agent</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the agent from the registry this should be used only on agents which already stopped transport connection</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hdel</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">agents_descriptions_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">agents_descriptions_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">remove_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the context from the registry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hdel</span><span class="p">(</span><span class="s2">&quot;contexts&quot;</span><span class="p">,</span> <span class="n">context_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">contexts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context_name</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">register_tool</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tool</span> <span class="p">:</span> <span class="n">WiseAgentTool</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a tool with the registry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;tools&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">tool</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tool</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">tools</span><span class="p">[</span><span class="n">tool</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tool</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_tools</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentTool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of tools</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">dictionary</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="s2">&quot;tools&quot;</span><span class="p">)</span>
            <span class="n">return_dictionary</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentTool</span><span class="p">]</span><span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
                 <span class="n">return_dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">return_dictionary</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tools</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_tool</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WiseAgentTool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the tool with the given name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">pipe</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">piped_res</span><span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;tools&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">tool_name</span><span class="p">)</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;tools&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">tool_name</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">piped_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">piped_res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_agent_names_and_descriptions</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of agent names and descriptions.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[str]: the list of agent descriptions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">agent_descriptions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">agent_name</span><span class="p">,</span> <span class="n">agent_description</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">fetch_agents_descriptions_dict</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">agent_descriptions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Agent Name: </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2"> Agent Description: </span><span class="si">{</span><span class="n">agent_description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">agent_descriptions</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.does_context_exist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">does_context_exist</span><span class="p">(</span><span class="n">context_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the context with the given name</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">does_context_exist</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the context with the given name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;contexts&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">context_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span>  <span class="bp">cls</span><span class="o">.</span><span class="n">contexts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">context_name</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.fetch_agents_descriptions_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fetch_agents_descriptions_dict</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the dict with the agent names as keys and descriptions as values</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>    
<span class="k">def</span> <span class="nf">fetch_agents_descriptions_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the dict with the agent names as keys and descriptions as values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">agents_descriptions_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.find_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">config_directory</span><span class="o">=</span><span class="s1">&#39;.wise-agents&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Find the file in the current directory or the home directory.</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">find_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">config_directory</span><span class="o">=</span><span class="s2">&quot;.wise-agents&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the file in the current directory or the home directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Step 1: Check the current directory</span>
    <span class="n">local_path</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">config_directory</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">local_path</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">local_path</span>

    <span class="c1"># Step 2: Check the home directory</span>
    <span class="n">home_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
    <span class="n">home_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">home_dir</span><span class="p">,</span> <span class="n">config_directory</span><span class="p">,</span><span class="n">file_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">home_path</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">home_path</span>

    <span class="c1"># If the file is not found in any of these locations, throw an exception</span>
    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File &#39;</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&#39; not found in current directory, home directory, as &#39;</span><span class="si">{</span><span class="n">config_directory</span><span class="si">}</span><span class="s2">&#39;/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.get_agent_description" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_agent_description</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the agent description for the agent with the given name</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_agent_description</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the agent description for the agent with the given name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">return_byte</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">agent_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">return_byte</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">return_byte</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">agents_descriptions_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.get_agent_names_and_descriptions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_agent_names_and_descriptions</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the list of agent names and descriptions.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[str]</code>
              
              <div class="doc-md-description">
                <p>List[str]: the list of agent descriptions</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_agent_names_and_descriptions</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the list of agent names and descriptions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: the list of agent descriptions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">agent_descriptions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">agent_name</span><span class="p">,</span> <span class="n">agent_description</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">fetch_agents_descriptions_dict</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">agent_descriptions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Agent Name: </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2"> Agent Description: </span><span class="si">{</span><span class="n">agent_description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">agent_descriptions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.get_config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_config</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the configuration and initialize the redis database
for more information see 
https://wise-agents.github.io/wise_agents_architecture/#distributed-architecture</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the configuration and initialize the redis database</span>
<span class="sd">    for more information see </span>
<span class="sd">    https://wise-agents.github.io/wise_agents_architecture/#distributed-architecture</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">cls</span><span class="o">.</span><span class="n">config</span> <span class="o">==</span> <span class="p">{}:</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">find_file</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;registry_config.yaml&quot;</span><span class="p">,</span> <span class="n">config_directory</span><span class="o">=</span><span class="s2">&quot;.wise-agents&quot;</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">config</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">),</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">and</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;redis_ssl&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">):</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span>
                <span class="n">host</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_host&quot;</span><span class="p">],</span> <span class="n">port</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_port&quot;</span><span class="p">],</span>
                <span class="n">username</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_username&quot;</span><span class="p">],</span> <span class="c1"># use your Redis user. More info https://redis.io/docs/latest/operate/oss_and_stack/management/security/acl/</span>
                <span class="n">password</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_password&quot;</span><span class="p">],</span> <span class="c1"># use your Redis password</span>
                <span class="n">ssl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">ssl_certfile</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_ssl_certfile&quot;</span><span class="p">],</span>
                <span class="n">ssl_keyfile</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_ssl_keyfile&quot;</span><span class="p">],</span>
                <span class="n">ssl_ca_certs</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_ssl_ca_certs&quot;</span><span class="p">])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_host&quot;</span><span class="p">],</span> <span class="n">port</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;redis_port&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">config</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.get_contexts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_contexts</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the list of contexts</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_contexts</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentContext</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the list of contexts</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">dictionary</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="s2">&quot;contexts&quot;</span><span class="p">)</span>
        <span class="n">return_dictionary</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentContext</span><span class="p">]</span><span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
             <span class="n">return_dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">return_dictionary</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">contexts</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.get_or_create_context" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_or_create_context</span><span class="p">(</span><span class="n">context_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the context with the given name</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_or_create_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WiseAgentContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Get the context with the given name &quot;&quot;&quot;</span>
    <span class="n">context</span> <span class="p">:</span> <span class="n">WiseAgentContext</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;contexts&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">context_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ctx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="p">:</span> <span class="n">WiseAgentContext</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">context</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">contexts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">context_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># context creation will also register the context in the registry</span>
        <span class="k">return</span> <span class="n">WiseAgentContext</span><span class="p">(</span><span class="n">context_name</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">context</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.get_tool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tool</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the tool with the given name</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_tool</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WiseAgentTool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the tool with the given name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">pipe</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">piped_res</span><span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;tools&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">tool_name</span><span class="p">)</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="s2">&quot;tools&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">tool_name</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">piped_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">piped_res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.get_tools" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tools</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the list of tools</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_tools</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentTool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the list of tools</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">dictionary</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="s2">&quot;tools&quot;</span><span class="p">)</span>
        <span class="n">return_dictionary</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WiseAgentTool</span><span class="p">]</span><span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
             <span class="n">return_dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">return_dictionary</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">tools</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.register_agent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_agent</span><span class="p">(</span><span class="n">agent_name</span><span class="p">,</span> <span class="n">agent_description</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Register an agent with the registry</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">register_agent</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">agent_name</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">agent_description</span> <span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register an agent with the registry</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">pipe</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">pipe</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span><span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">hexists</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">unwatch</span><span class="p">()</span>
                    <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Agent with name </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2"> already exists&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">multi</span><span class="p">()</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">agent_name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">agent_description</span><span class="p">)</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">WatchError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;WatchError in register_agent&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">agents_descriptions_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Agent with name </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2"> already exists&quot;</span><span class="p">)</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">agents_descriptions_dict</span><span class="p">[</span><span class="n">agent_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent_description</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.register_context" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_context</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Register a context with the registry</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>    
<span class="k">def</span> <span class="nf">register_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span> <span class="p">:</span> <span class="n">WiseAgentContext</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register a context with the registry</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;contexts&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">context</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">contexts</span><span class="p">[</span><span class="n">context</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.register_tool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_tool</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Register a tool with the registry</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">register_tool</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tool</span> <span class="p">:</span> <span class="n">WiseAgentTool</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register a tool with the registry</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s2">&quot;tools&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">tool</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tool</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">tools</span><span class="p">[</span><span class="n">tool</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tool</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.remove_context" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_context</span><span class="p">(</span><span class="n">context_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Remove the context from the registry</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">remove_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove the context from the registry</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hdel</span><span class="p">(</span><span class="s2">&quot;contexts&quot;</span><span class="p">,</span> <span class="n">context_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">contexts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentRegistry.unregister_agent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unregister_agent</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Remove the agent from the registry this should be used only on agents which already stopped transport connection</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">unregister_agent</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove the agent from the registry this should be used only on agents which already stopped transport connection</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_redis&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">redis_db</span><span class="o">.</span><span class="n">hdel</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">agents_descriptions_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">agents_descriptions_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="wiseagents.core.WiseAgentTool" class="doc doc-heading">
            <code>WiseAgentTool</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="yaml.YAMLObject">YAMLObject</span></code></p>


        <p>A WiseAgentTool is an abstract class that represents a tool that can be used by an agent to perform a specific task.</p>

              <details class="quote">
                <summary>Source code in <code>wiseagents/core.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">WiseAgentTool</span><span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">YAMLObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; A WiseAgentTool is an abstract class that represents a tool that can be used by an agent to perform a specific task.&#39;&#39;&#39;</span>
    <span class="n">yaml_tag</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;!wiseagents.WiseAgentTool&#39;</span>
    <span class="n">yaml_loader</span> <span class="o">=</span> <span class="n">WiseAgentsLoader</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">agent_tool</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">parameters_json_schema</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> 
                 <span class="n">call_back</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">       </span><span class="sd">&#39;&#39;&#39; Initialize the tool with the given name, description, agent tool, parameters json schema, and call back.</span>

<span class="sd">       Args:</span>
<span class="sd">           name (str): the name of the tool</span>
<span class="sd">           description (str): a description of what the tool does</span>
<span class="sd">           agent_tool (bool): whether the tool is an agent tool</span>
<span class="sd">           parameters_json_schema (dict): the json schema for the parameters of the tool</span>
<span class="sd">           call_back Optional(Callable[...,str]): the callback function to execute the tool&#39;&#39;&#39;</span>     
       <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">=</span> <span class="n">description</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">_parameters_json_schema</span> <span class="o">=</span> <span class="n">parameters_json_schema</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">_agent_tool</span> <span class="o">=</span> <span class="n">agent_tool</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">_call_back</span> <span class="o">=</span> <span class="n">call_back</span>
       <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_yaml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">loader</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Load the tool from a YAML node.</span>

<span class="sd">        Args:</span>
<span class="sd">            loader (yaml.Loader): the YAML loader</span>
<span class="sd">            node (yaml.Node): the YAML node&#39;&#39;&#39;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">construct_mapping</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_name&#39;</span><span class="p">),</span> <span class="n">description</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_description&#39;</span><span class="p">),</span> 
                   <span class="n">parameters_json_schema</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_parameters_json_schema&#39;</span><span class="p">),</span>
                   <span class="n">call_back</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_call_back&#39;</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of the tool.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the description of the tool.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">call_back</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the callback function of the tool.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_back</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">json_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the json schema of the tool.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters_json_schema</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_agent_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the agent tool of the tool.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agent_tool</span>

    <span class="k">def</span> <span class="nf">get_tool_OpenAI_format</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChatCompletionToolParam</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;The tool should be able to return itself in the form of a ChatCompletionToolParam</span>

<span class="sd">        Returns:</span>
<span class="sd">            ChatCompletionToolParam&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;function&quot;</span><span class="p">,</span>
                <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_schema</span>
                <span class="p">}</span> 
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">default_call_back</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;The tool should be able to execute the function with the given parameters&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">exec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;The tool should be able to execute the function with the given parameters&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_back</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_call_back</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_back</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgentTool.call_back" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">call_back</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the callback function of the tool.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgentTool.description" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">description</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the description of the tool.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgentTool.is_agent_tool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_agent_tool</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the agent tool of the tool.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgentTool.json_schema" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">json_schema</span><span class="p">:</span> <span class="nb">dict</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the json schema of the tool.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="wiseagents.core.WiseAgentTool.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the name of the tool.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentTool.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">agent_tool</span><span class="p">,</span> <span class="n">parameters_json_schema</span><span class="o">=</span><span class="p">{},</span> <span class="n">call_back</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the tool with the given name, description, agent tool, parameters json schema, and call back.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>name</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>the name of the tool</p>
              </div>
            </li>
            <li>
              <b><code>description</code></b>
                  (<code>str</code>)
              
              <div class="doc-md-description">
                <p>a description of what the tool does</p>
              </div>
            </li>
            <li>
              <b><code>agent_tool</code></b>
                  (<code>bool</code>)
              
              <div class="doc-md-description">
                <p>whether the tool is an agent tool</p>
              </div>
            </li>
            <li>
              <b><code>parameters_json_schema</code></b>
                  (<code>dict</code>, default:
                      <code>{}</code>
)
              
              <div class="doc-md-description">
                <p>the json schema for the parameters of the tool</p>
              </div>
            </li>
            <li>
              <b><code>call_back</code></b>
                  (<code>Optional(Callable[...,str]</code>, default:
                      <code>None</code>
)
              
              <div class="doc-md-description">
                <p>the callback function to execute the tool</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">agent_tool</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">parameters_json_schema</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> 
             <span class="n">call_back</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&#39;&#39;&#39; Initialize the tool with the given name, description, agent tool, parameters json schema, and call back.</span>

<span class="sd">   Args:</span>
<span class="sd">       name (str): the name of the tool</span>
<span class="sd">       description (str): a description of what the tool does</span>
<span class="sd">       agent_tool (bool): whether the tool is an agent tool</span>
<span class="sd">       parameters_json_schema (dict): the json schema for the parameters of the tool</span>
<span class="sd">       call_back Optional(Callable[...,str]): the callback function to execute the tool&#39;&#39;&#39;</span>     
   <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">=</span> <span class="n">description</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">_parameters_json_schema</span> <span class="o">=</span> <span class="n">parameters_json_schema</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">_agent_tool</span> <span class="o">=</span> <span class="n">agent_tool</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">_call_back</span> <span class="o">=</span> <span class="n">call_back</span>
   <span class="n">WiseAgentRegistry</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentTool.default_call_back" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">default_call_back</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The tool should be able to execute the function with the given parameters</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">default_call_back</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;The tool should be able to execute the function with the given parameters&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentTool.exec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">exec</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The tool should be able to execute the function with the given parameters</p>

            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">exec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;The tool should be able to execute the function with the given parameters&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_back</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_call_back</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_back</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentTool.from_yaml" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_yaml</span><span class="p">(</span><span class="n">loader</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Load the tool from a YAML node.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>loader</code></b>
                  (<code><span title="yaml.Loader">Loader</span></code>)
              
              <div class="doc-md-description">
                <p>the YAML loader</p>
              </div>
            </li>
            <li>
              <b><code>node</code></b>
                  (<code><span title="yaml.Node">Node</span></code>)
              
              <div class="doc-md-description">
                <p>the YAML node</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_yaml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">loader</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Load the tool from a YAML node.</span>

<span class="sd">    Args:</span>
<span class="sd">        loader (yaml.Loader): the YAML loader</span>
<span class="sd">        node (yaml.Node): the YAML node&#39;&#39;&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">construct_mapping</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_name&#39;</span><span class="p">),</span> <span class="n">description</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_description&#39;</span><span class="p">),</span> 
               <span class="n">parameters_json_schema</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_parameters_json_schema&#39;</span><span class="p">),</span>
               <span class="n">call_back</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_call_back&#39;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wiseagents.core.WiseAgentTool.get_tool_OpenAI_format" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tool_OpenAI_format</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The tool should be able to return itself in the form of a ChatCompletionToolParam</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="openai.types.chat.ChatCompletionToolParam">ChatCompletionToolParam</span></code>
              
              <div class="doc-md-description">
                <p>ChatCompletionToolParam</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>wiseagents/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_tool_OpenAI_format</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChatCompletionToolParam</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;The tool should be able to return itself in the form of a ChatCompletionToolParam</span>

<span class="sd">    Returns:</span>
<span class="sd">        ChatCompletionToolParam&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;function&quot;</span><span class="p">,</span>
            <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_schema</span>
            <span class="p">}</span> 
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../constants/" class="btn btn-neutral float-left" title="constants"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../graphdb/" class="btn btn-neutral float-right" title="graphdb">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../constants/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../graphdb/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
